<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:SmartRead.MVVM.ViewModels"
             x:Class="SmartRead.MVVM.Views.User.Account.ProfilePage"
             BackgroundColor="Black">

    <!-- Contenedor Principal con dos filas -->
    <Grid RowDefinitions="Auto,*">

        <!-- 🔹 Fila 0: Barra superior con menú hamburguesa -->
        <Grid BackgroundColor="Black" Padding="15,10,15,0">
            <Image Source="menu.png"
                   WidthRequest="40"
                   HeightRequest="40"
                   HorizontalOptions="End"
                   VerticalOptions="Start">
                <Image.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnMenuClicked"/>
                </Image.GestureRecognizers>
            </Image>
        </Grid>

        <!-- 🔹 Fila 1: Contenido Principal -->
        <ScrollView Grid.Row="1">
            <VerticalStackLayout Padding="20">

                <!-- Perfil de Usuario -->
                <VerticalStackLayout HorizontalOptions="Center" Margin="0,10,0,20">
                    <Image Source="usuario.png" WidthRequest="80" HeightRequest="80"/>
                    <Label Text="Usuario" TextColor="White" FontSize="18" HorizontalOptions="Center"/>
                </VerticalStackLayout>

                <!-- Progreso de Lectura -->
                <VerticalStackLayout HorizontalOptions="Center" Padding="0,10">
                    <Grid WidthRequest="220" HeightRequest="18">
                        <BoxView BackgroundColor="#E0E0E0" CornerRadius="10" WidthRequest="220" HeightRequest="18"/>
                        <BoxView BackgroundColor="#FFC766" CornerRadius="10" WidthRequest="100" HeightRequest="18" HorizontalOptions="Start"/>
                    </Grid>

                    <Label Text="Esta semana has leído" TextColor="White" FontSize="16" FontAttributes="Bold" HorizontalTextAlignment="Center" Padding="0,5,0,0"/>
                    <Label Text="58 páginas" TextColor="#FFC766" FontSize="14" FontAttributes="Bold" HorizontalTextAlignment="Center"/>
                </VerticalStackLayout>

                <!-- Separador -->
                <BoxView BackgroundColor="#808080" HeightRequest="1" HorizontalOptions="FillAndExpand" Margin="0,10,0,10"/>

                <!-- 🔹 Sección: Libros que te han gustado -->
                <Label Text="Libros que te han gustado" TextColor="White" FontSize="16" Margin="0,10"/>
                <HorizontalStackLayout HorizontalOptions="Start" Margin="0,5,0,0">
                    <VerticalStackLayout HorizontalOptions="Start">
                        <!-- Imagen del libro -->
                        <Image Source="libro1.png"
                               WidthRequest="100"
                               HeightRequest="150"
                               HorizontalOptions="Start"/>

                        <!-- Botón de Compartir -->
                        <HorizontalStackLayout HorizontalOptions="Start" Margin="0,5,0,0">
                            <HorizontalStackLayout.GestureRecognizers>
                                <TapGestureRecognizer Tapped="OnShareClicked"/>
                            </HorizontalStackLayout.GestureRecognizers>

                            <!-- Icono de compartir -->
                            <Image Source="icono_compartir.png"
                                   WidthRequest="20"
                                   HeightRequest="20"
                                   VerticalOptions="Center"/>

                            <!-- Texto "Comparte" -->
                            <Label Text="Comparte"
                                   TextColor="White"
                                   FontSize="14"
                                   VerticalOptions="Center"
                                   Margin="5,0,0,0"/>
                        </HorizontalStackLayout>
                    </VerticalStackLayout>
                </HorizontalStackLayout>

                <!-- 🔹 Carrusel Único para "Mi Lista" y "Leídos Recientemente" -->
                <CollectionView ItemsSource="{Binding Categories}">
                    <CollectionView.ItemsLayout>
                        <LinearItemsLayout Orientation="Vertical" ItemSpacing="10"/>
                    </CollectionView.ItemsLayout>
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <StackLayout>

                                <!-- Nombre de la Categoría -->
                                <Label Text="{Binding Name}"
                                       FontSize="18"
                                       TextColor="White"
                                       Margin="10,10,0,5"/>

                                <!-- Carrusel de Libros -->
                                <CollectionView ItemsSource="{Binding Books}"
                                                HeightRequest="180">
                                    <CollectionView.ItemsLayout>
                                        <LinearItemsLayout Orientation="Horizontal" ItemSpacing="5"/>
                                    </CollectionView.ItemsLayout>
                                    <CollectionView.ItemTemplate>
                                        <DataTemplate>
                                            <Frame Padding="0"
                                                   HasShadow="False"
                                                   BackgroundColor="Transparent"
                                                   BorderColor="Transparent"
                                                   CornerRadius="8"
                                                   WidthRequest="120"
                                                   HeightRequest="200">
                                                <Image Source="{Binding ImageSource}"
                                                       WidthRequest="120"
                                                       HeightRequest="180"/>
                                            </Frame>
                                        </DataTemplate>
                                    </CollectionView.ItemTemplate>
                                </CollectionView>

                            </StackLayout>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

            </VerticalStackLayout>
        </ScrollView>

    </Grid>

</ContentPage>
